<dataTemplate name="COST_DETAILS" description="COST DETAILS">
 <parameters>
  <parameter name="P_GL_USER" dataType="character" defaultValue="DBA.ADMIN" />
  <parameter name="P_ROLE_ID" dataType="character" defaultValue="ADMIN" />
  <parameter name="P_DATE_TIME_FORMAT" dataType="character" />
  <parameter name="P_END_TIME_FROM" dataType="character" />
  <parameter name="P_END_TIME_TO" dataType="character" />


		
  </parameters>
  <lexicals /> 
 <dataQuery>
  
  
 <sqlStatement name="Q_QUERY">
<![CDATA[ 
SELECT DISTINCT TO_CHAR(sh.END_TIME,'DD-MM-YYYY')	AS																				SHIPMENT_END_DATE,
		/* ORLSL.ORDER_RELEASE_LINE_GID                                																							OR_LINE_ID, */
		/* ORLS.ORDER_RELEASE_GID																																	OR_ID, */
		VORLS.SHIPMENT_GID 																																		SH_GID,
		(SELECT LISTAGG(OR_CAT.ORDER_RELEASE_REFNUM_VALUE,'|') WITHIN GROUP (ORDER BY OR_CAT.ORDER_RELEASE_GID)
		FROM ORDER_RELEASE_REFNUM OR_CAT
		WHERE OR_CAT.ORDER_RELEASE_GID = ORLS.ORDER_RELEASE_GID 
		AND OR_CAT.ORDER_RELEASE_REFNUM_QUAL_GID ='ULE.ULE_MATERIAL_CATEGORY') AS 																				CATEGORY,
		(SELECT LISTAGG(OR_MAT.ORDER_RELEASE_REFNUM_VALUE,'|') WITHIN GROUP (ORDER BY OR_MAT.ORDER_RELEASE_GID)
		FROM ORDER_RELEASE_REFNUM OR_MAT
		WHERE OR_MAT.ORDER_RELEASE_GID = ORLS.ORDER_RELEASE_GID 
		AND OR_MAT.ORDER_RELEASE_REFNUM_QUAL_GID ='ULE.ULE_MATERIAL_TYPE') AS 																					MATERIAL,
		/* ORLS.TRANSPORT_MODE_GID																																	TRANSPORT_MODE, */
		(SELECT SH_TEMP.TRANSPORT_MODE_GID
		FROM SHIPMENT SH_TEMP
		WHERE SH_TEMP.SHIPMENT_GID = VORLS.SHIPMENT_GID
		
		)																																						TRANSPORT_MODE,

		CASE WHEN ORLS.ORDER_RELEASE_TYPE_GID = 'INBOUND' THEN 'INBOUND'
		ELSE 'OUTBOUND'
		END AS																																					INB_OUTB,
		
		ORLS.INCO_TERM_GID																																		INCOTERM,
		
/* 		NVL((SELECT LISTAGG(OR_CARR.ORDER_RELEASE_REFNUM_VALUE,'|') WITHIN GROUP (ORDER BY OR_CARR.ORDER_RELEASE_GID)
		FROM ORDER_RELEASE_REFNUM OR_CARR
		WHERE OR_CARR.ORDER_RELEASE_GID = ORLS.ORDER_RELEASE_GID 
		AND OR_CARR.ORDER_RELEASE_REFNUM_QUAL_GID ='UGO.ULE_CARRIAGE_CONDITION'),'-') AS 																		CARRIAGE_CONDITION, */
		
		(SELECT LISTAGG(OR_CONSIGNOR.INVOLVED_PARTY_CONTACT_GID,'|') WITHIN GROUP (ORDER BY OR_CONSIGNOR.ORDER_RELEASE_GID)
		FROM ORDER_RELEASE_INV_PARTY OR_CONSIGNOR
		WHERE OR_CONSIGNOR.ORDER_RELEASE_GID = ORLS.ORDER_RELEASE_GID 
		AND OR_CONSIGNOR.INVOLVED_PARTY_QUAL_GID ='UGO.UGO_CONSIGNOR') AS 																						CONSIGNOR_ID,
		
		(SELECT LISTAGG(LOC_TEMP.LOCATION_NAME,'|') WITHIN GROUP (ORDER BY LOC_TEMP.LOCATION_GID)
		FROM LOCATION LOC_TEMP,
		ORDER_RELEASE_INV_PARTY OR_CONSIGNOR
		WHERE
		OR_CONSIGNOR.ORDER_RELEASE_GID = ORLS.ORDER_RELEASE_GID 
		AND OR_CONSIGNOR.INVOLVED_PARTY_QUAL_GID ='UGO.UGO_CONSIGNOR'
		AND OR_CONSIGNOR.INVOLVED_PARTY_CONTACT_GID = LOC_TEMP.LOCATION_GID
		
		) AS																																					CONSIGNOR_NAME,
		(SELECT LISTAGG(LOC_TEMP.CITY,'|') WITHIN GROUP (ORDER BY LOC_TEMP.LOCATION_GID)
		FROM LOCATION LOC_TEMP,
		ORDER_RELEASE_INV_PARTY OR_CONSIGNOR
		WHERE
		OR_CONSIGNOR.ORDER_RELEASE_GID = ORLS.ORDER_RELEASE_GID 
		AND OR_CONSIGNOR.INVOLVED_PARTY_QUAL_GID ='UGO.UGO_CONSIGNOR'
		AND OR_CONSIGNOR.INVOLVED_PARTY_CONTACT_GID = LOC_TEMP.LOCATION_GID
		
		) AS																																					CONSIGNOR_CITY,
		(SELECT LISTAGG(LOC_TEMP.COUNTRY_CODE3_GID,'|') WITHIN GROUP (ORDER BY LOC_TEMP.LOCATION_GID)
		FROM LOCATION LOC_TEMP,
		ORDER_RELEASE_INV_PARTY OR_CONSIGNOR
		WHERE
		OR_CONSIGNOR.ORDER_RELEASE_GID = ORLS.ORDER_RELEASE_GID 
		AND OR_CONSIGNOR.INVOLVED_PARTY_QUAL_GID ='UGO.UGO_CONSIGNOR'
		AND OR_CONSIGNOR.INVOLVED_PARTY_CONTACT_GID = LOC_TEMP.LOCATION_GID
		
		) AS																																					CONSIGNOR_COUNTRY,
		
		(SELECT LISTAGG(OR_CONSIGNEE.INVOLVED_PARTY_CONTACT_GID,'|') WITHIN GROUP (ORDER BY OR_CONSIGNEE.ORDER_RELEASE_GID)
		FROM ORDER_RELEASE_INV_PARTY OR_CONSIGNEE
		WHERE OR_CONSIGNEE.ORDER_RELEASE_GID = ORLS.ORDER_RELEASE_GID 
		AND OR_CONSIGNEE.INVOLVED_PARTY_QUAL_GID ='CONSIGNEE') AS 																								CONSIGNEE_ID,
		
		(SELECT LISTAGG(LOC_TEMP.LOCATION_NAME,'|') WITHIN GROUP (ORDER BY LOC_TEMP.LOCATION_GID)
		FROM LOCATION LOC_TEMP,
		ORDER_RELEASE_INV_PARTY OR_CONSIGNOR
		WHERE
		OR_CONSIGNOR.ORDER_RELEASE_GID = ORLS.ORDER_RELEASE_GID 
		AND OR_CONSIGNOR.INVOLVED_PARTY_QUAL_GID ='CONSIGNEE'
		AND OR_CONSIGNOR.INVOLVED_PARTY_CONTACT_GID = LOC_TEMP.LOCATION_GID
		
		) AS																																					CONSIGNEE_NAME,
		(SELECT LISTAGG(LOC_TEMP.CITY,'|') WITHIN GROUP (ORDER BY LOC_TEMP.LOCATION_GID)
		FROM LOCATION LOC_TEMP,
		ORDER_RELEASE_INV_PARTY OR_CONSIGNOR
		WHERE
		OR_CONSIGNOR.ORDER_RELEASE_GID = ORLS.ORDER_RELEASE_GID 
		AND OR_CONSIGNOR.INVOLVED_PARTY_QUAL_GID ='CONSIGNEE'
		AND OR_CONSIGNOR.INVOLVED_PARTY_CONTACT_GID = LOC_TEMP.LOCATION_GID
		
		) AS																																					CONSIGNEE_CITY,
		(SELECT LISTAGG(LOC_TEMP.COUNTRY_CODE3_GID,'|') WITHIN GROUP (ORDER BY LOC_TEMP.LOCATION_GID)
		FROM LOCATION LOC_TEMP,
		ORDER_RELEASE_INV_PARTY OR_CONSIGNOR
		WHERE
		OR_CONSIGNOR.ORDER_RELEASE_GID = ORLS.ORDER_RELEASE_GID 
		AND OR_CONSIGNOR.INVOLVED_PARTY_QUAL_GID ='CONSIGNEE'
		AND OR_CONSIGNOR.INVOLVED_PARTY_CONTACT_GID = LOC_TEMP.LOCATION_GID
		
		) AS																																					CONSIGNEE_COUNTRY,

		ORLS.SOURCE_LOCATION_GID AS																																SOURCE_LOCATION_ID,
		(SELECT LOC_TEMP.LOCATION_NAME
		FROM LOCATION LOC_TEMP
		WHERE
		LOC_TEMP.LOCATION_GID = ORLS.SOURCE_LOCATION_GID
		) AS																																					SOURCE_LOC_NAME,
		(SELECT LOC_TEMP.CITY
		FROM LOCATION LOC_TEMP
		WHERE
		LOC_TEMP.LOCATION_GID = ORLS.SOURCE_LOCATION_GID
		) AS																																					SOURCE_LOC_CITY,
		(SELECT LOC_TEMP.COUNTRY_CODE3_GID
		FROM LOCATION LOC_TEMP
		WHERE
		LOC_TEMP.LOCATION_GID = ORLS.SOURCE_LOCATION_GID
		) AS																																					SOURCE_LOC_COUNTRY,
		
		ORLS.PORT_OF_LOAD_LOCATION_GID AS																														POL,
		(SELECT LOC_TEMP.LOCATION_NAME
		FROM LOCATION LOC_TEMP
		WHERE
		LOC_TEMP.LOCATION_GID = ORLS.PORT_OF_LOAD_LOCATION_GID
		) AS																																					POL_NAME,
		(SELECT LOC_TEMP.CITY
		FROM LOCATION LOC_TEMP
		WHERE
		LOC_TEMP.LOCATION_GID = ORLS.PORT_OF_LOAD_LOCATION_GID
		) AS																																					POL_CITY,
		(SELECT LOC_TEMP.COUNTRY_CODE3_GID
		FROM LOCATION LOC_TEMP
		WHERE
		LOC_TEMP.LOCATION_GID = ORLS.PORT_OF_LOAD_LOCATION_GID
		) AS																																					POL_COUNTRY,
		
		ORLS.PORT_OF_DIS_LOCATION_GID AS																														POD,
		(SELECT LOC_TEMP.LOCATION_NAME
		FROM LOCATION LOC_TEMP
		WHERE
		LOC_TEMP.LOCATION_GID = ORLS.PORT_OF_DIS_LOCATION_GID
		) AS																																					POD_NAME,
		(SELECT LOC_TEMP.CITY
		FROM LOCATION LOC_TEMP
		WHERE
		LOC_TEMP.LOCATION_GID = ORLS.PORT_OF_DIS_LOCATION_GID
		) AS																																					POD_CITY,
		(SELECT LOC_TEMP.COUNTRY_CODE3_GID
		FROM LOCATION LOC_TEMP
		WHERE
		LOC_TEMP.LOCATION_GID = ORLS.PORT_OF_DIS_LOCATION_GID
		) AS																																					POD_COUNTRY,
		
		ORLS.DEST_LOCATION_GID AS																																DEST_LOCATION_ID,
		(SELECT LOC_TEMP.LOCATION_NAME
		FROM LOCATION LOC_TEMP
		WHERE
		LOC_TEMP.LOCATION_GID = ORLS.DEST_LOCATION_GID
		) AS																																					DEST_LOC_NAME,
		(SELECT LOC_TEMP.CITY
		FROM LOCATION LOC_TEMP
		WHERE
		LOC_TEMP.LOCATION_GID = ORLS.DEST_LOCATION_GID
		) AS																																					DEST_LOC_CITY,
		(SELECT LOC_TEMP.COUNTRY_CODE3_GID
		FROM LOCATION LOC_TEMP
		WHERE
		LOC_TEMP.LOCATION_GID = ORLS.DEST_LOCATION_GID
		) AS																																					DEST_LOC_COUNTRY,
		(SELECT ORLS_REF.ORDER_RELEASE_REFNUM_VALUE
		FROM ORDER_RELEASE_REFNUM ORLS_REF
		WHERE
		ORLS_REF.ORDER_RELEASE_GID = ORLS.ORDER_RELEASE_GID
		AND ORLS_REF.ORDER_RELEASE_REFNUM_QUAL_GID='ULE.ULE_TRANSPORT_CONDITION'
		
		) AS																																					TRANSPORT_CONDITION,
		NVL(ORLS.EQUIPMENT_GROUP_GID,'-')																														EQUIPMENT_GR,
		(SELECT SH_TEMP.SERVPROV_GID
		FROM SHIPMENT SH_TEMP
		WHERE VORLS.SHIPMENT_GID = SH_TEMP.SHIPMENT_GID
		
		)	AS																																					SERVPROV_ID,
		(SELECT SERVPROV_TEMP.LOCATION_NAME
		FROM SHIPMENT SH_TEMP,
				LOCATION SERVPROV_TEMP
		WHERE VORLS.SHIPMENT_GID = SH_TEMP.SHIPMENT_GID
			AND SH_TEMP.SERVPROV_GID = SERVPROV_TEMP.LOCATION_GID
		
		)	AS																																					SERVPROV_NAME,
		
		LTRIM(TO_CHAR(SH.TOTAL_WEIGHT_BASE*0.45,'999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')) 																GROSS_WEIGHT_KG,
		/* LTRIM(TO_CHAR(ORLS.TOTAL_WEIGHT_BASE*0.45,'999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')) 																GROSS_WEIGHT_KG, */
		/* LTRIM(TO_CHAR(ORLSL.ITEM_PACKAGE_COUNT,'999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')) 																PACKAGE_COUNT, */
		
		(SELECT LISTAGG(SHS_STATUS_CANC.STATUS_VALUE_GID,'/') WITHIN GROUP (ORDER BY SHS_STATUS_CANC.SHIPMENT_GID)
				FROM SHIPMENT_STATUS SHS_STATUS_CANC
				WHERE SHS_STATUS_CANC.SHIPMENT_GID = VORLS.SHIPMENT_GID 
				AND SHS_STATUS_CANC.STATUS_TYPE_GID = 'UGO.TRANSPORT CANCELLATION'
		)																																						SH_CANCELATION_STATUS,
		(SELECT LISTAGG(SHS_STATUS_CANC.STATUS_VALUE_GID,'/') WITHIN GROUP (ORDER BY SHS_STATUS_CANC.ORDER_RELEASE_GID)
				FROM ORDER_RELEASE_STATUS SHS_STATUS_CANC
				WHERE SHS_STATUS_CANC.ORDER_RELEASE_GID = VORLS.ORDER_RELEASE_GID 
				AND SHS_STATUS_CANC.STATUS_TYPE_GID = 'UGO.CANCELLED'
		)																																						OR_CANCELATION_STATUS,
	
		(SELECT SH_TEMP.INSERT_USER
		FROM SHIPMENT SH_TEMP
		WHERE SH_TEMP.SHIPMENT_GID = VORLS.SHIPMENT_GID
		) AS																																					SH_INSERT_USER,
/* 		(SELECT LISTAGG(II.INVOICE_NUMBER,'/') WITHIN GROUP (ORDER BY ORLS.ORDER_RELEASE_GID)
		FROM INVOICE II 
		WHERE II.INVOICE_GID IN
		(SELECT ILCR.INVOICE_GID
		FROM ORDER_RELEASE_LINE ORLSL_TEMP,
			INVOICE_LINEITEM_COST_REF ILCR
			
		WHERE ORLSL_TEMP.ORDER_RELEASE_LINE_GID = ILCR.	COST_REFERENCE_GID
			AND ORLSL_TEMP.ORDER_RELEASE_GID = ORLS.ORDER_RELEASE_GID)
		
		) 																																						INVOICE_NUMBERS, */

				
			/* 	TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN INV_LINE.FREIGHT_CHARGE_GID = 'EUR' THEN INV_LINE.FREIGHT_CHARGE
				ELSE NVL2(INV_LINE.FREIGHT_CHARGE * EXCHRATES.EXCHANGE_RATE, 
				INV_LINE.FREIGHT_CHARGE * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				
				FROM INVOICE_LINEITEM INV_LINE
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(INV_LINE.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND INV_LINE.FREIGHT_CHARGE_GID = EXCHRATES.FROM_CURRENCY_GID 
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR'),
				ORDER_RELEASE_LINE OR_LINE
				
				WHERE IVLI.INVOICE_GID = INV_LINE.INVOICE_GID
				AND OR_LINE.ORDER_RELEASE_GID = ORLS.ORDER_RELEASE_GID
				AND OR_LINE.ORDER_RELEASE_LINE_GID = ORLSL.ORDER_RELEASE_LINE_GID
				AND	(INV_LINE.ACCESSORIAL_CODE_GID ='UGO.UGO_BAS' OR INV_LINE.ACCESSORIAL_CODE_GID IS NULL)
				GROUP BY
				INV_LINE.INVOICE_GID
				),0))																																				BASE_COST_BAS, */
				(SELECT LISTAGG(ORLS_REF.ORDER_RELEASE_REFNUM_VALUE,'|') WITHIN GROUP (ORDER BY ORLS_REF.ORDER_RELEASE_GID)
				FROM ORDER_RELEASE_REFNUM ORLS_REF
				WHERE ORLS_REF.ORDER_RELEASE_REFNUM_QUAL_GID ='UGO.UGO_FINAL_BILLING_NUMBER_SOURCE'
				AND ORLS_REF.ORDER_RELEASE_GID = ORLS.ORDER_RELEASE_GID
				) 																																					BILL_NUMBER,												
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID 
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(SH_COST_TEMP.COST_TYPE ='B' OR (COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_FREIGHT_COST_BASIC_FTL')))
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			BASE_COST_EUR,
				
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID 
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_FTL_FREIGHT_COST_CORRECTION','UGO.UGO_FCL_FREIGHT_COST_CORRECTION'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			FREIGHTCOST_CORRECTION,
				
				
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID 
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.FUEL_SURCHARGE_BULK_OCEAN_24','UGO.FUEL_SURCHARGE_INTERMODAL_BULK_OCEAN_25','UGO.UGO_FUEL_REIMBURSMENT'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			FUEL_SURCHARGE,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID 
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	((COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_FUEL_SURCHARGE_CORRECTION')))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_FUEL_SURCHARGE_CORRECTION,

				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID 
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	((COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_FUEL_SURCHARGE_DESTINATION')))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			FUEL_SURCHARGE_DESTINATION,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID 
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	((COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_FUEL_SURCHARGE_ORIGIN')))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			FUEL_SURCHARGE_ORIGIN,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID 
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	((COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.LTL_FREIGHTCOST_CORRECTION')))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			LTL_FREIGHTCOST_CORRECTION,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_ADDITIONAL_CLEANING_REQUIRED'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_ADD_CLEANING_REQ,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_CANCELLATION_COST'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_CANCELLATION_COST,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_CONTAINER_COOLING'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_CONTAINER_COOLING,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_CREDIT_NOTE'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_CREDIT_NOTE,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_CUSTOM_CLEARANCE_EXPORT'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_CUSTOM_CLEARANCE_EXPORT,
	
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_CUSTOM_CLEARANCE_IMPORT'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_CUSTOM_CLEARANCE_IMPORT,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_DEMURRAGE_AT_CUSTOMS'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_DEMURRAGE_AT_CUSTOMS,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_DEMURRAGE_AT_TERMINAL'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_DEMURRAGE_AT_TERMINAL,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_DEMURRAGE_LOADING_COST'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_DEMURRAGE_LOADING_COST,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_HEATING_COSTS'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_HEATING_COSTS,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_DETENTION'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_DETENTION,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_DEMURRAGE_UNLOADING_COST'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_DEMURRAGE_UNLOADING_COST,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_DG_SURCHARGE'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_DG_SURCHARGE,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_DOCUMENTATION_COST'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_DOCUMENTATION_COST,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.SECOND_DRIVER'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			SECOND_DRIVER,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_PICK_UP_FEE'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_PICK_UP_FEE,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_TANK_CHASSIS_HIRE'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_TANK_CHASSIS_HIRE,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_STORAGE_COSTS'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_STORAGE_COSTS,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.TERMINAL_CHANGE'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			TERMINAL_CHANGE,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_WEEKEND_COST'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_WEEKEND_COST,
				
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_TERMINAL_HANDLING_COST'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_TERMINAL_HANDLING_COST,
				
				
				
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID 
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	((COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_CONTAINER_STUFFING_DESTUFFING')))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			CONTAINER_STUFFING_DESTUFFING,
				
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID 
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	((COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_DEMURRAGE_AT_THE_PORT')))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_DEMURRAGE_AT_THE_PORT,
				
				
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_OTHC'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			OTHC,
				
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_DTHC'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			DTHC,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_INLAND_ORIGIN'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_INLAND_ORIGIN,

				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_ADDITIONAL_DISTANCE'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_ADDITIONAL_DISTANCE,
				TRIM(NVL((SELECT TO_CHAR((SUM(CASE
				WHEN SH_COST_TEMP.COST_GID = 'EUR' THEN SH_COST_TEMP.COST
				ELSE NVL2(SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 
				SH_COST_TEMP.COST * EXCHRATES.EXCHANGE_RATE, 0)
				END)),'999999999999D99','NLS_NUMERIC_CHARACTERS = '', ''')
				
				FROM SHIPMENT_COST SH_COST_TEMP
				LEFT OUTER JOIN CURRENCY_EXCHANGE_RATE EXCHRATES ON (TO_CHAR(SH_COST_TEMP.INSERT_DATE, 'Q-YYYY') = TO_CHAR(EXCHRATES.EFFECTIVE_DATE, 'Q-YYYY') 
				AND SH_COST_TEMP.COST_GID = EXCHRATES.FROM_CURRENCY_GID
				AND EXCHRATES.EXCHANGE_RATE_GID = 'ULE.ULE_QTY_EXCHANGE' 
				AND EXCHRATES.TO_CURRENCY_GID = 'EUR')
				WHERE SH_COST_TEMP.SHIPMENT_GID=SH.SHIPMENT_GID
				AND	(COST_TYPE = 'A' AND ACCESSORIAL_CODE_GID IN ('UGO.UGO_ALL_IN_RATE'))
				
				GROUP BY SH_COST_TEMP.SHIPMENT_GID
				),0))																																			UGO_ALL_IN_RATE,
				(select orls_ref.ORDER_RELEASE_REFNUM_VALUE
from order_release_refnum orls_ref
where orls_ref.ORDER_RELEASE_GID = orls.ORDER_RELEASE_GID
and orls_ref.ORDER_RELEASE_REFNUM_QUAL_GID = 'UGO.UGO_ORIGIN_PAYER'

) 																													UGO_ORIGIN_PAYER,
(select orls_ref.ORDER_RELEASE_REFNUM_VALUE
from order_release_refnum orls_ref
where orls_ref.ORDER_RELEASE_GID = orls.ORDER_RELEASE_GID
and orls_ref.ORDER_RELEASE_REFNUM_QUAL_GID = 'UGO.UGO_DEST_PAYER'

) 																													UGO_DEST_PAYER,	
(select orls_ref.ORDER_RELEASE_REFNUM_VALUE
from order_release_refnum orls_ref
where orls_ref.ORDER_RELEASE_GID = orls.ORDER_RELEASE_GID
and orls_ref.ORDER_RELEASE_REFNUM_QUAL_GID = 'ULE.ULE_GLN'

) 																													GLN,	
(select orls_ref.ORDER_RELEASE_REFNUM_VALUE
from order_release_refnum orls_ref
where orls_ref.ORDER_RELEASE_GID = orls.ORDER_RELEASE_GID
and orls_ref.ORDER_RELEASE_REFNUM_QUAL_GID = 'ULE.ULE_COST CENTER'

) 																													COST_CENTER,
(select ss.STATUS_VALUE_GID
from shipment_status ss
where ss.SHIPMENT_GID = sh.SHIPMENT_GID
and ss.STATUS_TYPE_GID ='UGO.TRANSPORT CANCELLATION'

)																													CANCELLATION_STATUS
				

FROM
ORDER_RELEASE ORLS,
SHIPMENT SH,
/* ORDER_RELEASE_LINE ORLSL, */
/* ALLOCATION_OR_LINE_D AOLD, */
VIEW_SHIPMENT_ORDER_RELEASE VORLS
/* INVOICE_LINEITEM_COST_REF ILCR, */
/* INVOICE_LINEITEM IVLI */


WHERE
/* ORLS.ORDER_RELEASE_GID=ORLSL.ORDER_RELEASE_GID */
SH.SHIPMENT_GID = VORLS.SHIPMENT_GID
/* AND ORLSL.ORDER_RELEASE_LINE_GID = AOLD.ORDER_RELEASE_LINE_GID */
AND VORLS.ORDER_RELEASE_GID = ORLS.ORDER_RELEASE_GID
AND ORLS.DOMAIN_NAME='UGO'
AND (SELECT SH_TEMP.TRANSPORT_MODE_GID
		FROM SHIPMENT SH_TEMP
		WHERE SH_TEMP.SHIPMENT_GID = VORLS.SHIPMENT_GID
		
		)	NOT IN ('UL_OCEAN','UL_LCL')
/* AND ILCR.COST_REFERENCE_GID = ORLSL.ORDER_RELEASE_LINE_GID */
/* AND IVLI.INVOICE_GID = ILCR.INVOICE_GID */
/* AND IVLI.INVOICE_GID IS NOT NULL */


-- AND SH.END_TIME BETWEEN TO_DATE('01-03-2015','DD-MM-YYYY') AND TO_DATE('20-03-2015','DD-MM-YYYY')

AND trunc(SH.END_TIME) BETWEEN trunc(TO_DATE(:P_END_TIME_FROM,:P_DATE_TIME_FORMAT)) AND trunc(TO_DATE(:P_END_TIME_TO,:P_DATE_TIME_FORMAT))

AND TRUNC(SH.END_TIME) <= trunc(TO_DATE(:P_END_TIME_FROM,:P_DATE_TIME_FORMAT))+100




/* AND	SH.END_TIME BETWEEN TRUNC(TRUNC(TRUNC(TRUNC(SYSDATE,'MM')-1,'MM')-1,'MM')-1,'MM')  AND TRUNC(SYSDATE,'MM') -- PREV 3 MONTHS MAX */

/* AND	SH.END_TIME BETWEEN TO_DATE(:INSERT_DATE_FROM,:P_DATE_TIME_FORMAT) AND TO_DATE(:INSERT_DATE_TO,:P_DATE_TIME_FORMAT) */


/* AND VORLS.SHIPMENT_GID ='UGO.10002860' */




]]> 
 </sqlStatement> 
 
 </dataQuery>
 <dataStructure> 
 <group name="Q_QUERY" dataType="varchar2" source="Q_QUERY">
   <element name="SHIPMENT_END_DATE" dataType="varchar2" value="SHIPMENT_END_DATE" />
   <element name="SH_GID" dataType="varchar2" value="SH_GID" />
   <element name="CATEGORY" dataType="varchar2" value="CATEGORY" />
   <element name="MATERIAL" dataType="varchar2" value="MATERIAL" />
   <element name="TRANSPORT_MODE" dataType="varchar2" value="TRANSPORT_MODE" />
   <element name="INB_OUTB" dataType="varchar2" value="INB_OUTB" />
   <element name="INCOTERM" dataType="varchar2" value="INCOTERM" />
   <element name="CONSIGNOR_ID" dataType="varchar2" value="CONSIGNOR_ID" />
   <element name="CONSIGNOR_NAME" dataType="varchar2" value="CONSIGNOR_NAME" />
   <element name="CONSIGNOR_CITY" dataType="varchar2" value="CONSIGNOR_CITY" />
   <element name="CONSIGNOR_COUNTRY" dataType="varchar2" value="CONSIGNOR_COUNTRY" />
   <element name="CONSIGNEE_ID" dataType="varchar2" value="CONSIGNEE_ID" />
   <element name="CONSIGNEE_NAME" dataType="varchar2" value="CONSIGNEE_NAME" />
   <element name="CONSIGNEE_CITY" dataType="varchar2" value="CONSIGNEE_CITY" />
   <element name="CONSIGNEE_COUNTRY" dataType="varchar2" value="CONSIGNEE_COUNTRY" />
   <element name="SOURCE_LOCATION_ID" dataType="varchar2" value="SOURCE_LOCATION_ID" />
   <element name="SOURCE_LOC_NAME" dataType="varchar2" value="SOURCE_LOC_NAME" />
   <element name="SOURCE_LOC_CITY" dataType="varchar2" value="SOURCE_LOC_CITY" />
   <element name="SOURCE_LOC_COUNTRY" dataType="varchar2" value="SOURCE_LOC_COUNTRY" />
   <element name="POL" dataType="varchar2" value="POL" />
   <element name="POL_NAME" dataType="varchar2" value="POL_NAME" />
   <element name="POL_CITY" dataType="varchar2" value="POL_CITY" />
   <element name="POL_COUNTRY" dataType="varchar2" value="POL_COUNTRY" />
   <element name="POD" dataType="varchar2" value="POD" />
   <element name="POD_NAME" dataType="varchar2" value="POD_NAME" />
   <element name="POD_CITY" dataType="varchar2" value="POD_CITY" />
   <element name="POD_COUNTRY" dataType="varchar2" value="POD_COUNTRY" />
   <element name="DEST_LOCATION_ID" dataType="varchar2" value="DEST_LOCATION_ID" />
   <element name="DEST_LOC_NAME" dataType="varchar2" value="DEST_LOC_NAME" />
   <element name="DEST_LOC_CITY" dataType="varchar2" value="DEST_LOC_CITY" />
   <element name="DEST_LOC_COUNTRY" dataType="varchar2" value="DEST_LOC_COUNTRY" />
   <element name="TRANSPORT_CONDITION" dataType="varchar2" value="TRANSPORT_CONDITION" />
   <element name="EQUIPMENT_GR" dataType="varchar2" value="EQUIPMENT_GR" />
   <element name="SERVPROV_ID" dataType="varchar2" value="SERVPROV_ID" />
   <element name="SERVPROV_NAME" dataType="varchar2" value="SERVPROV_NAME" />
   <element name="GROSS_WEIGHT_KG" dataType="varchar2" value="GROSS_WEIGHT_KG" />
   <element name="SH_CANCELATION_STATUS" dataType="varchar2" value="SH_CANCELATION_STATUS" />
   <element name="OR_CANCELATION_STATUS" dataType="varchar2" value="OR_CANCELATION_STATUS" />
   <element name="SH_INSERT_USER" dataType="varchar2" value="SH_INSERT_USER" />
   <element name="BILL_NUMBER" dataType="varchar2" value="BILL_NUMBER" />
   <element name="BASE_COST_EUR" dataType="varchar2" value="BASE_COST_EUR" />
   <element name="FREIGHTCOST_CORRECTION" dataType="varchar2" value="FREIGHTCOST_CORRECTION" />
   <element name="FUEL_SURCHARGE" dataType="varchar2" value="FUEL_SURCHARGE" />
   <element name="UGO_FUEL_SURCHARGE_CORRECTION" dataType="varchar2" value="UGO_FUEL_SURCHARGE_CORRECTION" />
   <element name="FUEL_SURCHARGE_DESTINATION" dataType="varchar2" value="FUEL_SURCHARGE_DESTINATION" />
   <element name="FUEL_SURCHARGE_ORIGIN" dataType="varchar2" value="FUEL_SURCHARGE_ORIGIN" />
   <element name="LTL_FREIGHTCOST_CORRECTION" dataType="varchar2" value="LTL_FREIGHTCOST_CORRECTION" />
   <element name="UGO_ADD_CLEANING_REQ" dataType="varchar2" value="UGO_ADD_CLEANING_REQ" />
   <element name="UGO_CANCELLATION_COST" dataType="varchar2" value="UGO_CANCELLATION_COST" />
   <element name="UGO_CONTAINER_COOLING" dataType="varchar2" value="UGO_CONTAINER_COOLING" />
   <element name="UGO_CREDIT_NOTE" dataType="varchar2" value="UGO_CREDIT_NOTE" />
   <element name="UGO_CUSTOM_CLEARANCE_EXPORT" dataType="varchar2" value="UGO_CUSTOM_CLEARANCE_EXPORT" />
   <element name="UGO_CUSTOM_CLEARANCE_IMPORT" dataType="varchar2" value="UGO_CUSTOM_CLEARANCE_IMPORT" />
   <element name="UGO_DEMURRAGE_AT_CUSTOMS" dataType="varchar2" value="UGO_DEMURRAGE_AT_CUSTOMS" />
   <element name="UGO_DEMURRAGE_AT_TERMINAL" dataType="varchar2" value="UGO_DEMURRAGE_AT_TERMINAL" />
   <element name="UGO_DEMURRAGE_LOADING_COST" dataType="varchar2" value="UGO_DEMURRAGE_LOADING_COST" />
   <element name="UGO_HEATING_COSTS" dataType="varchar2" value="UGO_HEATING_COSTS" />
   <element name="UGO_DETENTION" dataType="varchar2" value="UGO_DETENTION" />
   <element name="UGO_DEMURRAGE_UNLOADING_COST" dataType="varchar2" value="UGO_DEMURRAGE_UNLOADING_COST" />
   <element name="UGO_DG_SURCHARGE" dataType="varchar2" value="UGO_DG_SURCHARGE" />
   <element name="UGO_DOCUMENTATION_COST" dataType="varchar2" value="UGO_DOCUMENTATION_COST" />
   <element name="SECOND_DRIVER" dataType="varchar2" value="SECOND_DRIVER" />
   <element name="UGO_PICK_UP_FEE" dataType="varchar2" value="UGO_PICK_UP_FEE" />
   <element name="UGO_TANK_CHASSIS_HIRE" dataType="varchar2" value="UGO_TANK_CHASSIS_HIRE" />
   <element name="UGO_STORAGE_COSTS" dataType="varchar2" value="UGO_STORAGE_COSTS" />
   <element name="TERMINAL_CHANGE" dataType="varchar2" value="TERMINAL_CHANGE" />
   <element name="UGO_WEEKEND_COST" dataType="varchar2" value="UGO_WEEKEND_COST" />
   <element name="UGO_TERMINAL_HANDLING_COST" dataType="varchar2" value="UGO_TERMINAL_HANDLING_COST" />
   <element name="CONTAINER_STUFFING_DESTUFFING" dataType="varchar2" value="CONTAINER_STUFFING_DESTUFFING" />
   <element name="UGO_DEMURRAGE_AT_THE_PORT" dataType="varchar2" value="UGO_DEMURRAGE_AT_THE_PORT" />
   <element name="OTHC" dataType="varchar2" value="OTHC" />
   <element name="DTHC" dataType="varchar2" value="DTHC" />
   <element name="UGO_INLAND_ORIGIN" dataType="varchar2" value="UGO_INLAND_ORIGIN" />
   <element name="UGO_ADDITIONAL_DISTANCE" dataType="varchar2" value="UGO_ADDITIONAL_DISTANCE" />
   <element name="UGO_ALL_IN_RATE" dataType="varchar2" value="UGO_ALL_IN_RATE" />
   <element name="UGO_ORIGIN_PAYER" dataType="varchar2" value="UGO_ORIGIN_PAYER" />
   <element name="UGO_DEST_PAYER" dataType="varchar2" value="UGO_DEST_PAYER" />
   <element name="GLN" dataType="varchar2" value="GLN" />
   <element name="COST_CENTER" dataType="varchar2" value="COST_CENTER" />
   <element name="CANCELLATION_STATUS" dataType="varchar2" value="CANCELLATION_STATUS" />

 </group>

  
  </dataStructure>
  </dataTemplate>